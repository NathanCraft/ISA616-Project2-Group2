---
title: "Student Success Dashboard Group 2"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
#runtime: shiny
---
<style>                    

.navbar, [data-toggle=tab], .navbar-brand {

  background-color: red!important;

  border-color: black;

  color: white!important;

}

 

.navbar .navbar-nav > li > a:hover, .navbar .navbar-nav > li > a:focus {

  background-color: crimson!important;

}

 

.navbar .navbar-nav > li > a:active {

  background-color: crimson!important;

}

</style>
```{r setup, include=FALSE,echo=FALSE}
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)

#package intialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(tidyverse, #for data manipulation
               plotly, #for interactive plots
               flexdashboard, #to make a dashboard
               fontawesome, #for icons
               DT #for better tables
               )

student_data = read_csv("CleanedStudentSuccessData.csv")
```

# Student Success Project Overview {data-orientation=columns}

Description of project

# Salary Trends {data-orientation=columns}

## Column {data-width=600}

### Average FSB Graduate Salary Over Time 

```{r,echo=FALSE}
library(tidyverse)  
library(ggplot2)
library(dplyr)

avg_salary_data <- student_data %>%
  group_by(year.x) %>%
  summarise(avg_salary = mean(survey_salary, na.rm = TRUE))

# Create the bar plot with ggplot2
p <- ggplot(avg_salary_data, aes(x = year.x, y = avg_salary)) +
  geom_bar(stat = "identity", fill = "darkred") +
  labs(x = "Year",
       y = "Average Salary") +
  theme_bw()

# Convert ggplot2 plot to plotly
ggplotly(p)
```

### Average FSB Graduate Salary Over Time by Primary Major 

```{r,echo=FALSE}
avg_salary_data <- student_data %>%
  group_by(year.x, major1) %>%
  summarise(avg_salary = mean(survey_salary, na.rm = TRUE))

# Create the line plot
p=ggplot(avg_salary_data, aes(x = year.x, y = avg_salary, color = major1)) +
  geom_line() +
  labs(x = "Year",
       y = "Average Salary") +
  theme_bw()
ggplotly(p)
```

## Column {data-width=300}

### Major with the Most Growth in Salary 

```{r,echo=FALSE}

```
### Major with the Least Growth in Salary 

```{r,echo=FALSE}

```

# Placement Trends {data-orientation=columns}

## Column {data-width=600}

### Average FSB Graduate Placement Rate Over Time

```{r,echo=FALSE}
bar_chart_data <- student_data %>%
  group_by(year.x) %>%
  summarise(placement_rate = sum(placement) / n())

# Bar Chart
p = ggplot(bar_chart_data, aes(x = year.x, y = placement_rate)) +
  geom_bar(stat = "identity", fill = "darkred") +
  labs(x = "Year",
       y = "Placement Rate") +
  theme_bw()
ggplotly(p)
```

### Average FSB Graduate Placement Rate Over Time by Primary Major 

```{r,echo=FALSE}
time_series_data <- student_data %>%
  group_by(year.x, major1) %>%
  summarise(placement_rate = sum(placement) / n())

# Time Series Chart
p=ggplot(time_series_data, aes(x = year.x, y = placement_rate, color = major1)) +
  geom_line() +
  labs(x = "Year",
       y = "Placement Rate") +
  theme_bw()
ggplotly(p)
```

## Column {data-width=300}

### Major with the Most Growth in Placement Rate

```{r,echo=FALSE}
placement_growth = student_data %>%
  group_by(major1, year.x) %>%
  summarise(placement_rate = sum(placement) / n()) %>%
  group_by(major1) %>%
  summarise(max_increase = max(placement_rate) - min(placement_rate)) %>%
  arrange(desc(max_increase)) %>%
  slice(1)

gauge_value <- round(placement_growth$max_increase, 3)*100

gauge(gauge_value, min = 0, max = 100, symbol = '%', gaugeSectors(
  success = c(80, 100), warning = c(40, 79), danger = c(0, 39)))
```

### Major with the Least Growth in Placement Rate 
```{r,echo=FALSE}
p <- student_data %>%
  group_by(major1, year.x) %>%
  summarise(placement_rate = sum(placement) / n()) %>%
  group_by(major1) %>%
  summarise(
    initial_placement_rate = first(placement_rate),
    final_placement_rate = last(placement_rate),
    max_increase = final_placement_rate - initial_placement_rate
  ) %>%
  arrange(max_increase) %>%
  slice(1) %>%
  ggplot(aes(x = "", y = max_increase, fill = major1)) +
  geom_col(width = 0.7) +
  geom_text(aes(label = scales::percent(max_increase)),
            position = position_stack(vjust = 0.5)) +
  labs(title = "Major with the Lowest Growth in Placement Rate",
       x = NULL,
       y = "Percentage Increase") +
  theme_minimal() +
  theme(legend.position = "none")
# Convert ggplot object to a plotly object
p <- ggplotly(p)
p
```


